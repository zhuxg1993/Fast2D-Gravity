% This code is designed to compute the gravity components (Gx, Gz) and gravity gradient tensor components (Gxz, Gzz) generated by a density contrast model discretized into trapezoidal cells. 

% Here, Gx and Gz denote the horizontal and vertical components of gravity, respectively;

Gxz and Gzz are the corresponding gravity gradient tensor components;

while Fx, Fz, Fxz, and Fzz represent the corresponding kernel matrices.

% The code provides four implementations with increasing levels of optimization:

Method 1: Conventional calculation without optimization;

Method 2: Simplified formulas for vertical and horizontal edges;

Method 3: Further optimization with precomputation and storage of edge contributions, building on Method 2;

Method 4: Additional optimization via precomputation and storage of node contributions, based on Method 3.

% These implementations are intended to demonstrate and compare the efficiency gains achieved at each optimization step.

% For practical use, simply employ the code of Method 4 for computation.

% A test model is included in the file model.mat for verification and performance testing. It contains:

% mod: density contrast matrix, whose rows and columns correspond to the model grid;

% nodex & nodez: node coordinates (x and z) for each trapezoidal cell.

% gobs: the first column contains the x-coordinates of each observation point, and the second column contains the z-coordinates.

% To perform computations using this program, users must prepare the four files mentioned above.

% The main program is 'main.m'. Running this file will perform forward gravity modeling on the provided test model.

% Users may also supply their own density models and node coordinate files. 

% The code supports gravity and gravity gradient tensor calculations for models discretized into general trapezoidal cells-including rectangles as a special case.
